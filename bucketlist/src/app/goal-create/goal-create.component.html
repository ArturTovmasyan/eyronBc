<!--{% extends "AppBundle::layout.html.twig" %}-->

<!--{% block angularApp %} <html ngApp="goal" data-ng-controller="goalAdd"> {% endblock %}-->

<!--{% block content %}-->
<!--{{ parent() }}-->

<!--{% if goalId is defined and goalId %}-->
<div class="form-modal" style="width: auto;display: none;position: absolute;z-index: 2000;">
    <!--data-ng-controller="goalEnd"-->
    <!--{{ render(controller("AppBundle:Goal:manage", {id: goalId})) }}-->
</div>
<!--{% endif %}-->

<form method="post" id="goal-create-form" class="main-form" action="#" enctype="multipart/form-data">
    <!--data-ng-init="redirectPath='{{ path('user_profile') }}'"-->
    <div class="content-top bg-white">
        <div class="container">
            <div class="row">
                <div class="col-md-6">

                    <div class="row">
                        <div class="col-xs-1 suggest-input">
                            <!--<input id="{{ form.status.vars.id }}" name="{{ form.status.vars.full_name}}" type="checkbox" value="1" >-->
                            <!--{% if form.status.vars.data == 1 %} checked {% endif %}-->
                            <md-checkbox class="example-margin" name="isPublic" [(ngModel)]="isPublic">
                            </md-checkbox>
                        </div>

                        <div class="col-xs-11">
                            <h3 class="text-purple">
                                {{ 'goal.public'|translate }}
                            </h3>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-sm-10 col-sm-offset-1">
                            <p class="text-gray">{{ 'goal.agree'|translate }}</p>
                        </div>
                    </div>

                </div>

                <div class="col-md-6 text-right">
                    <div class="buttons">

                        <div (click)="preview()" class="btn btn-transparent goal-view-submit"
                                name="btn_preview">
                            <span>{{ 'goal.preview'|translate }}</span>
                        </div>

                        <div *ngIf="!isPrivate" (click)="createDraft()" class="btn btn-transparent draft-save-submit" name="btn_save_draft">
                            <span *ngIf="!id">{{ 'draft.create'|translate }}</span>
                            <span *ngIf="id">{{ 'draft.update'|translate }}</span>
                        </div>

                        <div type="submit" (click)="save()"
                                class="btn btn-purple goal-create-submit"
                                name="btn_publish">
                            <!--data-ls-jquery-modal-->
                            <!--data-ls-identity="goalSave"-->
                            <!--data-ls-template="[[ ::goalSubmitTemplate ]]"-->
                            <span *ngIf="id && isPrivate">{{ 'goal.edit'|translate }}</span>
                            <span *ngIf="!id || !isPrivate">{{ 'goal.publish'|translate }}</span>
                            <i class="icon-arrow-right"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="goals">

                    <div class="row bg-white">
                        <div class="col-xs-10 col-xs-offset-1">
                            <div class="form-group">
                                <input type="text" name="title" required="required" maxlength="64" pattern=".{3,}"
                                       class="form-control title" placeholder="Title" autocomplete="off"
                                       [(ngModel)]="title"
                                       (ngModelChange)="getGoals()">
                                <!--{% if form.vars.value.title %}data-ng-init="addTitle ='{{ form.vars.value.title }}'" {% endif %}-->
                                <!--{{ form_widget(form.title, {'attr': {'class':'form-control title', 'placeholder' : 'Title', 'data-ng-model' : "addTitle",-->
                                <!--'data-ng-change' : "searchGoal($event)"} }) }}-->

                            </div>
                            <div *ngIf="haveIdeas && showIdeas" class="padding-top"></div>
                        </div>
                    </div>

                    <div class="row bg-grey" *ngIf="haveIdeas && showIdeas">
                        <div class="col-xs-12">
                            <div class="row no-gutter existing-menu">
                                <div class="col-xs-10">
                                    <h3 class="text-left pull-left text-dark">{{ 'goal.existing'|translate }}</h3>

                                    <!--<a href="#" (click)="slickConfig.method.slickPrev()">-->
                                        <!--<i class="icon-arrow-left">-->
                                            <!--<span class="path1"></span><span class="path2"></span>-->
                                        <!--</i>-->
                                    <!--</a>-->

                                    <!--<a href="#" (click)="slickConfig.method.slickNext()">-->
                                        <!--<i class="icon-arrow-right"></i>-->
                                    <!--</a>-->

                                </div>
                                <div class="col-xs-2 text-right" *ngIf="isMore">

                                    <a (click)="showIdeas = false">
                                        <i class="icon-remove-video-link"><span class="path2"></span><span
                                                class="path3"></span></i>
                                    </a>

                                </div>
                            </div>

                            <div class="row idea-item">
                                <div class="col-md-4 goals-animate" style="margin-top: 10px" *ngFor="let goal of goals">

                                    <div class="row idea-item">
                                        <div class="col-sm-12">
                                            <figure>
                                                <app-goal [goal]="goal">
                                                </app-goal>

                                                <app-goal-footer [goal]="goal"></app-goal-footer>
                                            </figure>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row bg-white">
                        <div class="col-xs-10 col-xs-offset-1 ">

                            <div class="form-group">

                                <textarea class="form-control margin-top" [(ngModel)]="description" name="description" placeholder="Description" rows="4" (ngModelChange)="changeDescription()"></textarea>
                                <div class="tags">
                                    <button *ngFor=" let tag of tags" type="button" class="btn btn-purple">
                                        {{tag }}
                                    </button>
                                </div>

                                <p class="text-gray" [innerHTML]="'goal.description_title' | translate">
                                </p>
                                <!--{{ form_widget(form.hashTags, {'attr': { "value" : "[[ tags ]]" } }) }}-->

                            </div>

                            <div class="text-center">
                                <!--data-ng-init="initDropzone('{{ path('app_rest_goal_addimages') }}')"-->
                                <my-dropzone [files]="files" [type]="'goal'" [existing]="existingFiles" [count]="imageCount"></my-dropzone>
                                <!--<div class="dropzone" id="goalDropzone">-->
                                    <!--<div class="dz-message">-->
                                        <!--<div class="row">-->
                                            <!--<div class="col-sm-12">-->
                                                <!--<span class="btn-purple">-->
                                                    <!--<i class="icon-cloud"></i>BROWSE-->
                                                <!--</span>-->

                                                <!--<h3 class="text-dark-gray">-->
                                                    <!--{{ 'drag_drop'|translate }}-->
                                                <!--</h3>-->
                                            <!--</div>-->
                                        <!--</div>-->

                                        <!--<p class="text-gray" [innerHTML]="'upload'|translate"></p>-->
                                        <!--&lt;!&ndash;| raw&ndash;&gt;-->
                                    <!--</div>-->
                                <!--</div>-->
                            </div>

                            <!--{{ form_widget(form.files, {'attr': { "value" : "[[ files ]]" } }) }}-->

                            <!--{% set images = form.vars.value.images %}-->

                            <div class="row">
                                <!--{% for image in images %}-->
                                <div class="col-sm-2" *ngFor="let image of images">
                                    <a (click)="removeImage(image.id)">
                                        <!--href="{{ path("app_get_rest_goal_removeimage", {'id' : image.id }) }}"-->
                                        <i class="icon-remove-video-link"><span class="path1"></span><span
                                                class="path2"></span><span class="path3"></span></i>
                                    </a>
                                    <!--<img src="{{ image.downloadLink }}" alt="{{ image.filename }}" class="img-responsive"/>-->
                                </div>
                                <!--{% endfor %}-->
                            </div>
                            <br/>

                            <div class="language lng" [class.sr-only]="!appUser.is_admin">
                                <!--{% if not is_granted("ROLE_ADMIN") %} class="sr-only" {% endif %}>-->
                                <!--{{ form_widget(form.language, {'attr': {'class':'form-control' } }) }}-->
                                <md-select placeholder="Language" style="width: 100%" [(ngModel)]="language" name="language">
                                    <md-option *ngFor="let language of languages" [value]="language.vale">
                                        {{ language.name }}
                                    </md-option>
                                </md-select>
                            </div>

                            <br/>
                            <!--{{ form_widget(form.videoLink, {'attr': {'class':'form-control', 'placeholder' : 'Type in a youtube or vimeo link in the field', 'ng-model': 'videolink' } }) }}-->
                            <input-video *ngFor="let video of videos_array; let i = index"
                                         [key]="i"
                                         [limit]="3"
                                         [link]="video"
                                         [array]="videos_array">

                            </input-video>
                            <br />
                        </div>
                    </div>

                    <!--{{ form_widget(form._token) }}-->
                </div>

            </div>
        </div>

    </div>

</form>