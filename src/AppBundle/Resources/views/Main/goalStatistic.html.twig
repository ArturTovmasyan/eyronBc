{% extends "SonataAdminBundle::standard_layout.html.twig" %}
{% block sonata_head_title %}
    Goal Statistic Page
{% endblock %}

{% block sonata_admin_content %}
<div class="row" style="text-align: center">
    <div class="col-lg-12">
        <div class="panel panel-blue">
            <div class="panel-heading">Goal statistic</div>
            <div class="panel-body">

                <div style="color: limegreen">Total count   {{ crawlerCount }}</div>
                <div style="color: limegreen">Average count   {{ crawlerAverage }}</div>
                <div id="statistic" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
                <table class="table ">
                    {% for name, count in perUserCreated %}
                        <tr {% if name == 'Total' %}class="danger"{% else %}class="info"{% endif %}>
                            <th style="text-align: center" >{{ name }}</th>
                            <td >{{ count }}</td>
                        </tr>
                    {% endfor %}
                </table>

                <div style="color: limegreen">Total count   {{ updateCount }}</div>
                <div style="color: limegreen">Average count   {{ updateAverage }}</div>
                <div id="updated" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

                <div style="color: limegreen">Total count   {{ publishCount }}</div>
                <div style="color: limegreen">Average count   {{ publishAverage }}</div>
                <div id="published" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

                <table class="table ">
                {% for name,count in perUser %}
                    <tr {% if name == 'Total' %}class="danger"{% else %}class="info"{% endif %}>
                        <th style="text-align: center" >{{ name }}</th>
                        <td >{{ count }}</td>
                    </tr>
                {% endfor %}
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}


{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('app/bower_components/highcharts/highcharts.js') }}"></script>
    <script src="{{ asset('app/bower_components/highcharts/modules/exporting.js') }}"></script>
    <script>
        $(function () {

            $('#statistic').highcharts({
                title: {
                    text: 'Created',
                    x: -20 //center
                },
                xAxis: {
                    categories: [
                        {% for category in createCategories %}
                        '{{ category }}',
                        {% endfor %}
                    ]},
                yAxis: {

                    plotLines: [{
                        value: 0,
                        width: 1,
                        color: '#808000'
                    }]
                },
                legend: {
                    layout: 'vertical',
                    align: 'right',
                    verticalAlign: 'middle',
                    borderWidth: 0
                },
                series: [
                    {% for axis in createAxis  %}
                    {
                        name: '{{ axis }}',
                        data: [
                            {% for object in createResult %}
                            {{ object[axis] }},
                            {% endfor %}
                        ]
                    },{% endfor %}
                ]

            });

            $('#updated').highcharts({
                title: {
                    text: 'Updated',
                    x: -20 //center
                },
                xAxis: {
                    categories: [
                        {% for object in updateResult %}
                        '{{ object['dates']|date('M d') }}',
                        {% endfor %}
                    ]
                },
                yAxis: {

                    plotLines: [{
                        value: 0,
                        width: 1,
                        color: '#808000'
                    }]
                },
                legend: {
                    layout: 'vertical',
                    align: 'right',
                    verticalAlign: 'middle',
                    borderWidth: 0
                },
                series: [{
                    name: 'Statistic Line',
                    data: [
                        {% for object in updateResult %}
                        {{ object['counts'] }},
                        {% endfor %}
                    ]
                }],
            });

            $('#published').highcharts({
                title: {
                    text: 'Published',
                    x: -20 //center
                },
                xAxis: {
                    categories: [
                {% for oll in ollDates %}
                '{{ oll }}',
                {% endfor %}
                ]},
                yAxis: {

                    plotLines: [{
                        value: 0,
                        width: 1,
                        color: '#808000'
                    }]
                },
                legend: {
                    layout: 'vertical',
                    align: 'right',
                    verticalAlign: 'middle',
                    borderWidth: 0
                },
                series: [
                        {% for userName in userNames  %}
                    {
                    name: '{{ userName }}',
                    data: [
                        {% for object in published %}
                        {{ object[userName]['counts'] }},
                        {% endfor %}
                    ]
                    },{% endfor %}
                ]

            });
        });
    </script>
{% endblock %}