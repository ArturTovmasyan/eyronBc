<div id="story-modal" data-ng-controller="goalDone">
    <div class="modal-top">
        <figure data-ng-if="userGoal.goal.cached_image">
            <img data-ng-src="[[ userGoal.goal.cached_image]]" alt="[[ userGoal.goal.title ]]" class="img-responsive"/>
        </figure>

        <span class="overlay"></span>

        <div>
            <h2 data-ng-class="{'title-smaller': userGoal.goal.title.length > 35, 'title-top': !userGoal.goal.author.show_name}">
                <span>[[ userGoal.goal.title ]]</span>
            </h2>
            {% if app.user %}
                <p data-ng-if="userGoal.goal.author && !userGoal.goal.author.is_admin && userGoal.goal.author.id == {{ app.user.id }}">
                    [[ userGoal.goal.author.show_name ]]
                </p>
            {% endif %}
            <ul>
                <li>
                    <a href="javascript:void(0)">
                        {{ 'block_listed'|trans | capitalize }}
                        <span>[[ userGoal.goal.stats.listedBy | number ]]</span>
                        <i class="icon-user-small"></i>
                    </a>
                </li>
                <li>
                    <a href="javascript:void(0)">
                        {{ 'block_completed'|trans | capitalize }}
                        <span>[[ userGoal.goal.stats.doneBy | number ]]</span>
                        <i class="icon-user-small"></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-10 col-xs-offset-1">
            <h3 class="story-title">{{ 'success_story.title'|trans }}</h3>

            <div>
                {#{{ form_errors(form) }}#}

                <form id="goal-done-form" action="#">

                    <div class="form-group row">
                        <div class="col-sm-12">
                            <i class="icon-pencil"></i>
                            <textarea required="required" name="story" data-ng-model="userGoal.story.story" class="form-control" placeholder="Success story ..." rows="4"></textarea>
                        </div>
                    </div>

                    <div class="text-center" data-ng-init="initDropzone('{{ path('add_story_images') }}')">
                        <div class="dropzone" id="goalDropzone">
                            <div class="dz-message">
                                <div class="row">
                                    <div class="col-sm-12">

                                        <h3 class="text-dark-gray">
                                            <i class="icon-cloud"></i>{{ 'drag_drop'|trans }}
                                        </h3>
                                    </div>
                                </div>

                                <p class="text-gray">{{ 'upload'|trans | raw}}</p>
                            </div>
                        </div>
                    </div>

                    {#{{ form_widget(form.files, {'attr': { "value" : "[[ files ]]" } }) }}#}

                    <div class="form-group">
                        <label class="text-dark-gray">Video</label>
                        <video-link data-ng-repeat="(k, video) in userGoal.videos_array"
                            data-key="k"
                            data-limit="3"
                            data-link="video.link"
                            data-array="userGoal.videos_array">
                        </video-link>
                    </div>

                    <div class="form-group text-center bottom">
                        <a href="javascript:void(0)" data-ng-click="save()" class="btn btn-purple button-lg">{{ 'btn_save'|trans }}</a>
                        <a href="javascript:void(0)" rel="modal:close" id="cancel" class="btn btn-transparent button-lg">{{ 'btn_cancel'|trans }}</a>
                    </div>

                </form>
            </div>
        </div>
     </div>
</div>